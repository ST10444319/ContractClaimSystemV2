@model ContractClaimSystem.Web.Models.Claim
@{
    ViewData["Title"] = "Submit Claim";
}
@if(TempData["Error"] != null){ <div class="alert error">@TempData["Error"]</div> }
@if(TempData["Success"] != null){ <div class="alert success">@TempData["Success"]</div> }

<div class="card">
  <h2>Submit Monthly Claim</h2>
  <form asp-action="Submit" method="post" enctype="multipart/form-data">
    <div class="row">
      <div class="col">
        <label>Lecturer Name</label>
        <input asp-for="LecturerName" class="input" />
        <span asp-validation-for="LecturerName" class="text-danger"></span>
      </div>
            <div class="col">
                <label>Hours Worked</label>
                <input asp-for="HoursWorked" class="input" type="number" step="0.5" id="hoursInput" />
            </div>
            <div class="col">
                <label>Hourly Rate</label>
                <input asp-for="HourlyRate" class="input" type="number" step="0.01" id="rateInput" />
            </div>
    </div>

    <div style="margin-top:12px">
      <label>Additional Notes</label>
      <textarea asp-for="Notes" class="textarea" rows="3"></textarea>
    </div>

    <div style="margin-top:12px">
      <label>Supporting Documents (pdf, docx, xlsx)</label>
      <input type="file" name="files" multiple class="input" />
    </div>

        <div style="margin-top:16px;display:flex;gap:10px;align-items:center">
            <strong>Total (auto):</strong>
            <span id="totalDisplay">R @Model.TotalAmount.ToString("0.00")</span>
        </div>

    <div style="margin-top:18px;text-align:right">
      <button class="btn" type="submit">Submit</button>
    </div>
  </form>
</div>

@section Scripts{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.13/jquery.validate.unobtrusive.min.js"></script>

    <script>
        function recalcTotal() {
            var hours = parseFloat($('#hoursInput').val()) || 0;
            var rate  = parseFloat($('#rateInput').val())  || 0;
            var total = hours * rate;
            $('#totalDisplay').text('R ' + total.toFixed(2));
        }

        $(function () {
            $('#hoursInput, #rateInput').on('input', recalcTotal);
        });
    </script>

}
